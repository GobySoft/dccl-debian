#!/usr/bin/make -f

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/cmake.mk


# Add here any variable or target overrides you need.

DEB_CMAKE_EXTRA_FLAGS = -Dbuild_doc=ON
DEB_MAKE_ENVVARS = CTEST_OUTPUT_ON_FAILURE=ON
DEB_MAKE_CHECK_TARGET = test
DEB_BUILD_PARALLEL = true


# bug for Ubuntu PPA Xenial armhf build machines
ifeq ($(shell (lsb_release -c | egrep -q "xenial") && echo "yes"),yes)
	ifeq ($(shell (arch | egrep -q "armv7l") && echo "yes"),yes)
		DEB_CMAKE_EXTRA_FLAGS += -Denable_testing=OFF
	else
		DEB_CMAKE_EXTRA_FLAGS += -Denable_testing=ON
	endif
else
	DEB_CMAKE_EXTRA_FLAGS += -Denable_testing=ON
endif


